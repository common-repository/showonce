(function(){function h(b,c){var a=b.getCursor(),d=b.getTokenAt(a),g=CodeMirror.innerMode(b.getMode(),d.state),f=g.state;if("xml"!=g.mode.name)return CodeMirror.Pass;var e=b.getOption("autoCloseTags"),j="html"==g.mode.configuration,g="object"==typeof e&&e.dontCloseTags||j&&l,j="object"==typeof e&&e.indentTags||j&&m;if(">"==c&&f.tagName){e=f.tagName;d.end>a.ch&&(e=e.slice(0,e.length-d.end+a.ch));var h=e.toLowerCase();if("tag"==d.type&&"closeTag"==f.type||d.string.indexOf("/")==d.string.length-1||g&& -1<k(g,h))return CodeMirror.Pass;f=(d=j&&-1<k(j,h))?CodeMirror.Pos(a.line+1,0):CodeMirror.Pos(a.line,a.ch+1);b.replaceSelection(">"+(d?"\n\n":"")+"</"+e+">",{head:f,anchor:f});d&&(b.indentLine(a.line+1),b.indentLine(a.line+2))}else if("/"==c&&"<"==d.string)(e=f.context&&f.context.tagName)&&b.replaceSelection("/"+e+">","end");else return CodeMirror.Pass}function k(b,c){if(b.indexOf)return b.indexOf(c);for(var a=0,d=b.length;a<d;++a)if(b[a]==c)return a;return-1}CodeMirror.defineOption("autoCloseTags", !1,function(b,c,a){if(c&&(a==CodeMirror.Init||!a)){a={name:"autoCloseTags"};if("object"!=typeof c||c.whenClosing)a["'/'"]=function(a){return h(a,"/")};if("object"!=typeof c||c.whenOpening)a["'>'"]=function(a){return h(a,">")};b.addKeyMap(a)}else!c&&(a!=CodeMirror.Init&&a)&&b.removeKeyMap("autoCloseTags")});var l="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),m="applet blockquote body button div dl fieldset form frameset h1 h2 h3 h4 h5 h6 head html iframe layer legend object ol p select table ul".split(" ")})();